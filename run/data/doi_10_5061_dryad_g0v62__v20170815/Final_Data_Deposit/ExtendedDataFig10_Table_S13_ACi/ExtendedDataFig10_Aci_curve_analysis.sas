title "DRIORTFACE analysis";
options ls=80 ps=1000 formdlim='_' nodate nonumber;
data SoyParams;
infile 'C:\Users\sbgray\Documents\Combined Soil H2O and driFACE manuscript\Raw data and code\Final\ExtendedDataFig10_Table_S13_ACi\DRIface_parameters_plotmeans.csv' dlm=',' firstobs=2 dsd missover;
input year$	DATE$	DOY$	ring	CO2$	plot$	block$	Vcmax25	Jmax25 vj25;
proc sort data=Soyparams;
by YEAR DOY;
run;


title "Dry FACE by years";
*Vcmax ANOVA;
proc mixed data=Work.soyparams method=REML;                                                                                                           
   class YEAR DOY CO2 plot BLOCK;                                                                                              
   model Vcmax25 = CO2|plot|DOY   / ddfm=kr htype=3 outp=WORK._PREDDRY ;                                                                                              
by year;
random block CO2(block) CO2*plot(block) ;
repeated DOY /sub=co2*plot*block type=cs;
lsmeans CO2*plot*doy /  pdiff=all ;
lsmeans DOY*CO2*plot / slice=CO2 slice=plot slice=co2*doy slice=plot*doy ;
run; 
proc univariate data=work._predDRY plot normal;
var resid;
by year;
run;quit;

*Jmax ANOVA;
proc mixed data=Work.soyparams method=REML;                                                                                                           
   class YEAR DOY CO2 plot BLOCK;                                                                                              
   model Jmax25 = CO2|plot|DOY   / ddfm=kr htype=3 outp=WORK._PREDDRY ;                                                                                              
by year;
random block CO2(block) CO2*plot(block) ;
repeated DOY /sub=co2*plot*block type=cs;
lsmeans CO2*plot*doy /  pdiff=all ;
lsmeans DOY*CO2*plot / slice=CO2 slice=plot slice=co2*doy slice=plot*doy ;
run; 
proc univariate data=work._predDRY plot normal;
var resid;
by year;
run;quit;
*Vcmax/Jmax ANOVA;
proc mixed data=Work.soyparams method=REML;                                                                                                           
   class YEAR DOY CO2 plot BLOCK;                                                                                              
   model vj25 = CO2|plot|DOY   / ddfm=kr htype=3 outp=WORK._PREDDRY ;                                                                                              
by year;
random block CO2(block) CO2*plot(block) ;
repeated DOY /sub=co2*plot*block type=cs;
lsmeans CO2*plot*doy /  pdiff=all ;
lsmeans DOY*CO2*plot / slice=CO2 slice=plot slice=co2*doy slice=plot*doy ;
run; 
proc univariate data=work._predDRY plot normal;
var resid;
by year;
run;quit;
